<!doctype html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <title>Karte | Berlin-Vegan</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <!-- build:css(.) styles/vendor.css -->
    <!-- endbuild -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- build:css(.tmp) styles/main.css -->
    <link rel="stylesheet" href="styles/main.css">
    <!-- endbuild -->
</head>
<body id="berlinVeganMapApp">
    <!--[if lt IE 7]>
    <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
      your browser</a> to improve your experience.</p>
    <![endif]-->

    <!-- Add your site or application content here -->
    <div>
        <div ng-view=""></div>
    </div>

    <!-- Google Analytics -->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
              (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
              m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-1323925-1');
        ga('send', 'pageview');
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.4.1/core.min.js"></script>

    <!-- build:js(.) scripts/vendor.js -->
    <!-- bower:js -->
    <script src="bower_components/jquery/dist/jquery.js"></script>
    <script src="bower_components/angular/angular.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script src="bower_components/angular-route/angular-route.js"></script>
    <!-- endbower -->
    <!-- endbuild -->
    <!-- build:js({.tmp,app}) scripts/scripts.js -->
    <script src="scripts/app.js"></script>
    <script src="scripts/services/info_window_view.js"></script>
    <script src="scripts/services/resources.js"></script>
    <script src="scripts/services/i18n.js"></script>
    <script src="scripts/services/opening_times.js"></script>
    <script src="scripts/services/util.js"></script>
    <script src="scripts/services/location_logic.js"></script>
    <script src="scripts/filters/location.js"></script>
    <script src="scripts/filters/kilometer.js"></script>
    <script src="scripts/controllers/main.js"></script>
    <!-- endbuild -->
    <script>
        var global_language;
        if (location.href.indexOf("lang=") !== -1) {
            global_language = location.href.split("lang=")[1];
        } else if (localStorage) {
            global_language = localStorage.getItem("lang") || "de";
        } else {
            var prefLang = getPreferredSupportedLanguage();
            global_language = prefLang || "de";
        }
        
        var region = (global_language === "en") ? "us" : "de";

        appendScript(
            "https://maps.googleapis.com/maps/api/js?language=" + global_language +"&region=" + region,
            function() { angular.bootstrap(document.querySelector("#berlinVeganMapApp"), ["berlinVeganMapApp"]); }
        );

        function getPreferredSupportedLanguage() {
            var preferredLanguages = getPreferredLanguages();
            for (var i = 0; i < preferredLanguages.length; i++) {
                var lang = preferredLanguages[i];
                if (lang === "en" || lang === "de") {
                    return lang;
                }
            }
            return null;
        }

        function getPreferredLanguages() {
            var preferredLanguages;
            if (navigator.languages !== undefined) {
                // Firefox, Chrome, Opera
                preferredLanguages = navigator.languages;
            } else if (navigator.browserLanguage !== undefined) {
                // IE11
                preferredLanguages = [navigator.browserLanguage];
            } else {
                preferredLanguages = [];
            }
            return preferredLanguages.map(
                function(it) {
                    // Remove optional region
                    return it.indexOf("-") !== -1 ? it.split("-")[0] : it;
                }
            );
        }

        function appendScript(url, onload) {
            var script = document.createElement('script');
            script.src = url;
            script.async = false;
            script.onload = onload;
            document.head.appendChild(script);
        }
    </script>
    </body>
</html>
